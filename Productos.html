<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css">
    <link rel="" href="https://cdn.datatables.net/fixedheader/3.1.6/css/fixedHeader.dataTables.min.css">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <title>Uso de Fetch</title>

    <style>
      body{
        background-color: cornflowerblue;
      }
      table thead {
            background:#302b63;
            color:white;
        }
    </style>
</head>
<body>

    <input type="text" id="filtro" placeholder="Buscar">
    <button id="aplicar-filtro">Filtrar</button>

    <div class="container mt-4 shadow-lg p-3 mb-5 bg-body rounded table-responsive">
      <table id="myTable" class="table table-bordered table-striped table-hover table-xl">
        <thead>
          <tr>
            <th>Name</th>
            <th>Industry</th>
            <th>Size</th>
            <th>Company Website</th>
            <th>Company Linkdln</th>
            <th>Contacts</th>
            <th>Opportunities</th>
            <th>Hq address</th>
            <th>Map cache</th>
          </tr>
        </thead>
        <tbody class="table">
        </tbody>
      </table>
    </div>
</body>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>

<script src="https://code.jquery.com/jquery-3.3.1.js"></script>
<script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/fixedheader/3.1.6/js/dataTables.fixedHeader.min.js"></script> 

<script>
    const baseId = 'appTsErgl1kPnkWgl';
    const apiKey = 'keykY5YjFxN23izT6';
    const table = 'Accounts';

    const url = `https://api.airtable.com/v0/${baseId}/${table}`;
    const headers = {
        Authorization: `Bearer ${apiKey}`,
        'Content-Type': 'application/json'
    };

    fetch(url, { headers })
        .then(response => response.json())
        .then(data => {
            const tableBody = document.querySelector('#myTable tbody');
            data.records.forEach(record => {
                const fields = record.fields;
                const row = tableBody.insertRow();
                const nameCell = row.insertCell();
                const industryCell = row.insertCell();
                const sizeCell = row.insertCell();
                const company_websiteCell = row.insertCell();
                const company_linkdlnCell = row.insertCell();
                const contactsCell = row.insertCell();
                const opportunitiesCell = row.insertCell();
                const hq_addressCell = row.insertCell();
                const map_cacheCell = row.insertCell();

                nameCell.innerHTML = fields.Name;
                industryCell.innerHTML = fields.Industry;
                sizeCell.innerHTML = fields.Size;
                company_websiteCell.innerHTML = fields.Company_website;
                company_linkdlnCell.innerHTML = fields.Company_Linkdln;
                contactsCell.innerHTML = fields.Contacts;
                opportunitiesCell.innerHTML = fields.Opportunities;
                hq_addressCell.innerHTML = fields.HQ_address;
                map_cacheCell.innerHTML = fields.Map_cache;
                
            });
        });


$(document).ready(function(){
    var table = $('#myTable').DataTable({
       orderCellsTop: true,
       fixedHeader: true 
    });

    //Creamos una fila en el head de la tabla y lo clonamos para cada columna
    $('#myTable thead tr').clone(true).appendTo( '#myTable thead' );

    $('#myTable thead tr:eq(1) th').each( function (i) {
        var title = $(this).text(); //es el nombre de la columna
        $(this).html( '<input type="text" placeholder="Search...'+title+'" />' );
 
        $( 'input', this ).on( 'keyup change', function () {
            if ( table.column(i).search() !== this.value ) {
                table
                    .column(i)
                    .search( this.value )
                    .draw();
            }
        } );
    } );   
});

      

</script>
</html>

